<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.32.2">
    <meta name="project" content="json_polyfill v0.1.3">


    <title>Overview — json_polyfill v0.1.3</title>
    <link rel="stylesheet" href="dist/html-erlang-EBZIIHAS.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-K7URE6B4.js"></script>
    <script src="dist/sidebar_items-C63BFE8B.js"></script>
    <script src="docs_config.js"></script>
    <script async src="dist/html-BHYOTRCH.js"></script>


  </head>
  <body data-type="extras" class="page-extra">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

      <div>
        <a href="https://github.com/williamthome/json_polyfill" class="sidebar-projectName" translate="no">
json_polyfill
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v0.1.3
        </div>
      </div>
    </div>
    <ul id="sidebar-listNav" class="sidebar-listNav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
Pages
        </button>
      </li>

        <li>
          <button id="modules-list-tab-button" role="tab" data-type="modules" aria-controls="modules-tab-panel" aria-selected="false" tabindex="-1">
            Modules
          </button>
        </li>


    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>

    <div id="modules-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="modules-list-tab-button" hidden>
      <ul id="modules-full-list" class="full-list"></ul>
    </div>


</nav>

<main class="content">
  <output role="status" id="toast"></output>

  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of json_polyfill</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search">
            <i class="ri-search-2-line ri-lg" aria-hidden="true" title="Submit search"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <h1>

      <a href="https://github.com/williamthome/json_polyfill/blob/v0.1.3/README.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>


    <span>json_polyfill</span>
  </h1>

<p>This lib is just a copy of the <code class="inline">json</code> module proposed in <a href="https://www.erlang.org/eeps/eep-0068">EEP 68</a> and <a href="https://www.erlang.org/news/168#highlights-for-rc2">introduced in OTP 27</a> by <a href="https://github.com/michalmuskala">Michał Muskała</a>.</p><p>Its intent is to act as a polyfill for apps that cannot currently be updated to OTP 27 or higher.</p><p>The module and function names are exactly the same. Then, when your app supports OTP &gt;= 27, just remove this lib from the dependencies.</p><h2 id="installation" class="section-heading">
  <a href="#installation" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Installation</span>
</h2>
<h3 id="erlang" class="section-heading">
  <a href="#erlang" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Erlang</span>
</h3>
<pre><code class="makeup erlang" translate="no"><span class="c1">% rebar.config</span><span class="w">
</span><span class="p" data-group-id="9457902993-1">{</span><span class="ss">deps</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9457902993-2">[</span><span class="p" data-group-id="9457902993-3">{</span><span class="ss">json_polyfill</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;0.1.3&quot;</span><span class="p" data-group-id="9457902993-3">}</span><span class="p" data-group-id="9457902993-2">]</span><span class="p" data-group-id="9457902993-1">}</span><span class="p">.</span></code></pre><h3 id="elixir" class="section-heading">
  <a href="#elixir" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Elixir</span>
</h3>
<pre><code class="makeup elixir" translate="no"><span class="c1"># mix.exs</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">deps</span><span class="w"> </span><span class="k" data-group-id="7070146702-1">do</span><span class="w">
  </span><span class="p" data-group-id="7070146702-2">[</span><span class="p" data-group-id="7070146702-3">{</span><span class="ss">:json_polyfill</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;~&gt; 0.1.3&quot;</span><span class="p" data-group-id="7070146702-3">}</span><span class="p" data-group-id="7070146702-2">]</span><span class="w">
</span><span class="k" data-group-id="7070146702-1">end</span></code></pre><h2 id="encode" class="section-heading">
  <a href="#encode" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Encode</span>
</h2>
<h3 id="encode-1" class="section-heading">
  <a href="#encode-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">encode/1</span>
</h3>
<p>Generates JSON corresponding to <code class="inline">Term</code>.</p><p>Supports basic data mapping:</p><table><thead><tr><th style="text-align: left;"><strong>Erlang</strong></th><th style="text-align: left;"><strong>JSON</strong></th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">integer() | float()</code></td><td style="text-align: left;">Number</td></tr><tr><td style="text-align: left;"><code class="inline">true | false</code></td><td style="text-align: left;">Boolean</td></tr><tr><td style="text-align: left;"><code class="inline">null</code></td><td style="text-align: left;">Null</td></tr><tr><td style="text-align: left;"><code class="inline">binary()</code></td><td style="text-align: left;">String</td></tr><tr><td style="text-align: left;"><code class="inline">atom()</code></td><td style="text-align: left;">String</td></tr><tr><td style="text-align: left;"><code class="inline">list()</code></td><td style="text-align: left;">Array</td></tr><tr><td style="text-align: left;"><code class="inline">#{binary() =&gt; _}</code></td><td style="text-align: left;">Object</td></tr><tr><td style="text-align: left;"><code class="inline">#{atom() =&gt; _}</code></td><td style="text-align: left;">Object</td></tr><tr><td style="text-align: left;"><code class="inline">#{integer() =&gt; _}</code></td><td style="text-align: left;">Object</td></tr></tbody></table><p>This is equivalent to <code class="inline">encode(Term, fun json:encode_value/2)</code>.</p><h4>Example</h4><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">&gt; </span><span class="nf">iolist_to_binary</span><span class="p" data-group-id="1162792608-1">(</span><span class="nc">json</span><span class="p">:</span><span class="nf">encode</span><span class="p" data-group-id="1162792608-2">(</span><span class="p" data-group-id="1162792608-3">#{</span><span class="ss">foo</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">&lt;&lt;</span><span class="s">&quot;bar&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="1162792608-3">}</span><span class="p" data-group-id="1162792608-2">)</span><span class="p" data-group-id="1162792608-1">)</span><span class="p">.</span><span class="w">
</span><span class="p">&lt;&lt;</span><span class="s">&quot;{\&quot;foo\&quot;:\&quot;bar\&quot;}&quot;</span><span class="p">&gt;&gt;</span></code></pre><h3 id="encode-2" class="section-heading">
  <a href="#encode-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">encode/2</span>
</h3>
<p>Generates JSON corresponding to <code class="inline">Term</code>.</p><p>Can be customised with the <code class="inline">Encoder</code> callback. The callback will be recursively called for all the data to be encoded and is expected to return the corresponding encoded JSON as iodata.</p><p>Various <code class="inline">encode_*</code> functions in this module can be used to help in constructing such callbacks.</p><h4>Example</h4><p>An encoder that uses a heuristic to differentiate object-like lists of key-value pairs from plain lists:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">&gt; </span><span class="nf">encoder</span><span class="p" data-group-id="7880255810-1">(</span><span class="p" data-group-id="7880255810-2">[</span><span class="p" data-group-id="7880255810-3">{</span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="7880255810-3">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="7880255810-2">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Value</span><span class="p">,</span><span class="w"> </span><span class="n">Encode</span><span class="p" data-group-id="7880255810-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">json</span><span class="p">:</span><span class="nf">encode_key_value_list</span><span class="p" data-group-id="7880255810-4">(</span><span class="n">Value</span><span class="p">,</span><span class="w"> </span><span class="n">Encode</span><span class="p" data-group-id="7880255810-4">)</span><span class="p">;</span><span class="gp unselectable">
&gt; </span><span class="nf">encoder</span><span class="p" data-group-id="7880255810-5">(</span><span class="n">Other</span><span class="p">,</span><span class="w"> </span><span class="n">Encode</span><span class="p" data-group-id="7880255810-5">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">json</span><span class="p">:</span><span class="nf">encode_value</span><span class="p" data-group-id="7880255810-6">(</span><span class="n">Other</span><span class="p">,</span><span class="w"> </span><span class="n">Encode</span><span class="p" data-group-id="7880255810-6">)</span><span class="p">.</span><span class="gp unselectable">
&gt; </span><span class="nf">custom_encode</span><span class="p" data-group-id="7880255810-7">(</span><span class="n">Value</span><span class="p" data-group-id="7880255810-7">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">json</span><span class="p">:</span><span class="nf">encode</span><span class="p" data-group-id="7880255810-8">(</span><span class="n">Value</span><span class="p">,</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="7880255810-9">(</span><span class="n">Value</span><span class="p">,</span><span class="w"> </span><span class="n">Encode</span><span class="p" data-group-id="7880255810-9">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nf">encoder</span><span class="p" data-group-id="7880255810-10">(</span><span class="n">Value</span><span class="p">,</span><span class="w"> </span><span class="n">Encode</span><span class="p" data-group-id="7880255810-10">)</span><span class="w"> </span><span class="k">end</span><span class="p" data-group-id="7880255810-8">)</span><span class="p">.</span><span class="gp unselectable">
&gt; </span><span class="nf">iolist_to_binary</span><span class="p" data-group-id="7880255810-11">(</span><span class="nf">custom_encode</span><span class="p" data-group-id="7880255810-12">(</span><span class="p" data-group-id="7880255810-13">[</span><span class="p" data-group-id="7880255810-14">{</span><span class="ss">a</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7880255810-15">[</span><span class="p" data-group-id="7880255810-15">]</span><span class="p" data-group-id="7880255810-14">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7880255810-16">{</span><span class="ss">b</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="7880255810-16">}</span><span class="p" data-group-id="7880255810-13">]</span><span class="p" data-group-id="7880255810-12">)</span><span class="p" data-group-id="7880255810-11">)</span><span class="p">.</span><span class="w">
</span><span class="p">&lt;&lt;</span><span class="s">&quot;{\&quot;a\&quot;:[],\&quot;b\&quot;:1}&quot;</span><span class="p">&gt;&gt;</span></code></pre><h2 id="decode" class="section-heading">
  <a href="#decode" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Decode</span>
</h2>
<h3 id="decode-1" class="section-heading">
  <a href="#decode-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">decode/1</span>
</h3>
<p>Parses a JSON value from <code class="inline">Binary</code>.</p><p>Supports basic data mapping:</p><table><thead><tr><th style="text-align: left;"><strong>JSON</strong></th><th style="text-align: left;"><strong>Erlang</strong></th></tr></thead><tbody><tr><td style="text-align: left;">Number</td><td style="text-align: left;"><code class="inline">integer() | float()</code></td></tr><tr><td style="text-align: left;">Boolean</td><td style="text-align: left;"><code class="inline">true | false</code></td></tr><tr><td style="text-align: left;">Null</td><td style="text-align: left;"><code class="inline">null</code></td></tr><tr><td style="text-align: left;">String</td><td style="text-align: left;"><code class="inline">binary()</code></td></tr><tr><td style="text-align: left;">Object</td><td style="text-align: left;"><code class="inline">#{binary() =&gt; _}</code></td></tr></tbody></table><h4>Errors</h4><ul><li><code class="inline">error(unexpected_end)</code> if <code class="inline">Binary</code> contains incomplete JSON value</li><li><code class="inline">error({invalid_byte, Byte})</code> if <code class="inline">Binary</code> contains unexpected byte or invalid UTF-8 byte</li><li><code class="inline">error({invalid_sequence, Bytes})</code> if <code class="inline">Binary</code> contains invalid UTF-8 escape</li></ul><h4>Example</h4><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">&gt; </span><span class="nc">json</span><span class="p">:</span><span class="nf">decode</span><span class="p" data-group-id="6626347461-1">(</span><span class="p">&lt;&lt;</span><span class="s">&quot;{\&quot;foo\&quot;: 1}&quot;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="6626347461-1">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="6626347461-2">#{</span><span class="p">&lt;&lt;</span><span class="s">&quot;foo&quot;</span><span class="p">&gt;&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="6626347461-2">}</span></code></pre><h3 id="decode-3" class="section-heading">
  <a href="#decode-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">decode/3</span>
</h3>
<p>Parses a JSON value from <code class="inline">Binary</code>.</p><p>Similar to <code class="inline">decode/1</code> except the decoding process can be customized with the callbacks specified in <code class="inline">Decoders</code>. The callbacks will use the <code class="inline">Acc</code> value as the initial accumulator.</p><p>Any leftover, unparsed data in <code class="inline">Binary</code> will be returned.</p><h4>Default callbacks</h4><p>All callbacks are optional. If not provided, they will fall back to implementations used by the <code class="inline">decode/1</code> function:</p><ul><li>for <code class="inline">array_start</code>: <code class="inline">fun(_) -&gt; [] end</code></li><li><p>for <code class="inline">array_push</code>: <code class="inline">fun(Elem, Acc) -&gt; [Elem | Acc] end</code></p></li><li>for <code class="inline">array_finish</code>: <code class="inline">fun(Acc, OldAcc) -&gt; {lists:reverse(Acc), OldAcc} end</code></li><li>for <code class="inline">object_start</code>: <code class="inline">fun(_) -&gt; [] end</code></li><li><p>for <code class="inline">object_push</code>: <code class="inline">fun(Key, Value, Acc) -&gt; [{Key, Value} | Acc] end</code></p></li><li>for <code class="inline">object_finish</code>: <code class="inline">fun(Acc, OldAcc) -&gt; {maps:from_list(Acc), OldAcc} end</code></li><li>for <code class="inline">float</code>: <code class="inline">fun erlang:binary_to_float/1</code></li><li>for <code class="inline">integer</code>: <code class="inline">fun erlang:binary_to_integer/1</code></li><li>for <code class="inline">string</code>: <code class="inline">fun (Value) -&gt; Value end</code></li><li>for <code class="inline">null</code>: the atom <code class="inline">null</code></li></ul><h4>Errors</h4><ul><li><code class="inline">error({invalid_byte, Byte})</code> if <code class="inline">Binary</code> contains unexpected byte or invalid UTF-8 byte</li><li><code class="inline">error({invalid_sequence, Bytes})</code> if <code class="inline">Binary</code> contains invalid UTF-8 escape</li><li><code class="inline">error(unexpected_end)</code> if <code class="inline">Binary</code> contains incomplete JSON value</li></ul><h4>Example</h4><p>Decoding object keys as atoms:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">&gt; </span><span class="n">Push</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="5609569675-1">(</span><span class="n">Key</span><span class="p">,</span><span class="w"> </span><span class="n">Value</span><span class="p">,</span><span class="w"> </span><span class="n">Acc</span><span class="p" data-group-id="5609569675-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="5609569675-2">[</span><span class="p" data-group-id="5609569675-3">{</span><span class="nf">binary_to_existing_atom</span><span class="p" data-group-id="5609569675-4">(</span><span class="n">Key</span><span class="p" data-group-id="5609569675-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">Value</span><span class="p" data-group-id="5609569675-3">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="n">Acc</span><span class="p" data-group-id="5609569675-2">]</span><span class="w"> </span><span class="k">end</span><span class="p">.</span><span class="gp unselectable">
&gt; </span><span class="nc">json</span><span class="p">:</span><span class="nf">decode</span><span class="p" data-group-id="5609569675-5">(</span><span class="p">&lt;&lt;</span><span class="s">&quot;{\&quot;foo\&quot;: 1}&quot;</span><span class="p">&gt;&gt;</span><span class="p">,</span><span class="w"> </span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5609569675-6">#{</span><span class="ss">object_push</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">Push</span><span class="p" data-group-id="5609569675-6">}</span><span class="p" data-group-id="5609569675-5">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="5609569675-7">{</span><span class="p" data-group-id="5609569675-8">#{</span><span class="ss">foo</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="5609569675-8">}</span><span class="p">,</span><span class="ss">ok</span><span class="p">,</span><span class="p">&lt;&lt;</span><span class="p">&gt;&gt;</span><span class="p" data-group-id="5609569675-7">}</span></code></pre><h2 id="license" class="section-heading">
  <a href="#license" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">License</span>
</h2>
<p>Erlang/OTP is released under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a>.</p><blockquote><p>%CopyrightBegin%</p><p>Copyright Ericsson AB 2010-2024. All Rights Reserved.</p><p>Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p><pre><code class="makeup erlang" translate="no"><span class="nc">http</span><span class="p">:</span><span class="o">/</span><span class="o">/</span><span class="ss">www</span><span class="p">.</span><span class="ss">apache</span><span class="p">.</span><span class="ss">org</span><span class="o">/</span><span class="ss">licenses</span><span class="o">/</span><span class="n">LICENSE</span><span class="o">-</span><span class="mf">2.0</span></code></pre><p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p><p>%CopyrightEnd%</p></blockquote>
</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="api-reference.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
API Reference
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="license.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
License
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/json_polyfill/0.1.3" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/json_polyfill/0.1.3">Hex Preview</a>

              (<a href="https://preview.hex.pm/preview/json_polyfill/0.1.3/show/README.md">current file</a>)

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="json_polyfill.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.32.2) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>


  </body>
</html>
